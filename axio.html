<html>
<head>
    <style>
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>
</head>

<body></body>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    function timeConverter(timestamp) {
        var d = new Date(timestamp * 1000), // Convert the passed timestamp to milliseconds
            yyyy = d.getFullYear(),
            mm = ('0' + (d.getMonth() + 1)).slice(-2), // Months are zero based. Add leading 0.
            dd = ('0' + d.getDate()).slice(-2), // Add leading 0.
            hh = d.getHours(),
            h = hh,
            min = ('0' + d.getMinutes()).slice(-2), // Add leading 0.
            ampm = 'AM',
            time;

        if (hh > 12) {
            h = hh - 12;
            ampm = 'PM';
        } else if (hh === 12) {
            h = 12;
            ampm = 'PM';
        } else if (hh == 0) {
            h = 12;
        }

        // ie: 2013-02-18, 8:35 AM	
        time = yyyy + '-' + mm + '-' + dd + ', ' + h + ':' + min + ' ' + ampm;

        return time;
    }

    function createTable(tableData) {
        var table = document.createElement('table');
        var tableBody = document.createElement('tbody');

        tableData.forEach(function(rowData) {
            var row = document.createElement('tr');
            let obValue = Object.values(rowData);
            obValue[2] = timeConverter(obValue[2]);

            obValue.forEach(function(cellData) {
                var cell = document.createElement('td');
                cell.appendChild(document.createTextNode(cellData));
                row.appendChild(cell);
            });


            tableBody.appendChild(row);
        });


        table.appendChild(tableBody);
        document.body.appendChild(table);

    }

    async function getunstakingdata() {

        let url = `https://api.eosnewyork.io/v1/chain/get_table_rows`;
        let data = JSON.stringify({
            "scope": "betdicestake",
            "code": "betdicestake",
            "table": "unstakinglog",
            "json": "true",
            "limit": 9999
        });



        let raw = await axios.post(url, data);
        let arr = raw.data.rows;
        arr.forEach(function(em){
           em.asset=em.asset.slice(0,em.asset.length-5);
        });
        arr=arr.sort((a,b)=>b.asset-a.asset);
        createTable(arr);
        console.log(arr);
        //document.getElementById("output").innerHTML = arr[0].user;



    }


    getunstakingdata();
</script>

</html>